
#ifndef SCM_LDATA_UTILITIES_GLSLH_INCLUDED
#define SCM_LDATA_UTILITIES_GLSLH_INCLUDED

vec3
unproject_depth(in sampler2D depth_image, in vec2 coord, in mat4 mvp)
{
    float d  = texelFetch(depth_image, ivec2(coord.xy), 0).r;
    vec4 csp = vec4(coord.xy / vec2(textureSize(depth_image, 0)), d, 1.0) * 2.0 - 1.0;
    vec4 osp = mvp * csp;
    osp     /= osp.w;

    return osp.xyz;
}

#endif // SCM_LDATA_UTILITIES_GLSLH_INCLUDED
